# 📦 과제 제출 가이드

## 제출 파일 목록

### 필수 제출 파일
✅ **배포과정설명.md** - 자동 배포 및 서비스 동작 흐름 설명 (메인 제출물)

### 추가 제공 파일 (참고용)
- `Dockerfile` - Docker 이미지 빌드 설정
- `Jenkinsfile` - CI/CD 파이프라인 정의
- `docker-compose.yml` - 로컬 테스트 환경
- `ecs-task-definition-*.json` - ECS Task 정의 (3개)
- `application-prod.properties` - 운영 환경 설정
- `README-DEVOPS.md` - 프로젝트 전체 가이드
- `scripts/local-build-test.sh` - 로컬 빌드 테스트 스크립트
- `scripts/aws-deploy.sh` - AWS 수동 배포 스크립트

---

## 📋 과제 요구사항 체크리스트

### ✅ 완료된 항목

#### 1. 애플리케이션 준비
- [x] Spring PetClinic을 3개 서비스로 분리 전략 수립 (동일 애플리케이션 복제)
- [x] Dockerfile 작성 (Multi-stage Build)
- [x] PostgreSQL 연동 설정 (application-prod.properties)

#### 2. CI/CD 구성
- [x] Jenkinsfile 작성 (7단계 파이프라인)
  - Checkout → Build → Docker Build → ECR Login → Push → Deploy → Verify
- [x] 병렬 처리 구현 (Push 및 Deploy 단계)
- [x] 에러 처리 및 로깅

#### 3. AWS 인프라 설정 파일
- [x] ECS Task Definition 3개 (front, back1, back2)
- [x] 환경변수 및 Secrets Manager 연동
- [x] Health Check 설정
- [x] CloudWatch Logs 구성

#### 4. 문서화
- [x] **배포과정설명.md** - 상세한 CI/CD 흐름 설명
  - 아키텍처 다이어그램
  - 6단계 배포 흐름 설명
  - 네트워크 및 보안 구성
  - 트러블슈팅 가이드
- [x] README-DEVOPS.md - 전체 구축 가이드
  - AWS 인프라 구축 10단계
  - Jenkins 설정 방법
  - 테스트 및 검증 방법

---

## 🚀 주요 구현 내용

### 1. 자동 배포 흐름 (End-to-End)
```
Git Push
   ↓
GitHub Webhook
   ↓
Jenkins 자동 빌드
   ├─ Gradle bootJar 빌드
   ├─ Docker 이미지 빌드
   ├─ ECR 로그인
   └─ ECR에 이미지 푸시 (병렬)
   ↓
ECS 서비스 재배포 (병렬)
   ├─ front-service
   ├─ back1-service
   └─ back2-service
   ↓
ALB Health Check
   ↓
서비스 안정화 대기
   ↓
배포 완료 (약 10분 소요)
```

### 2. 아키텍처 구성
- **VPC**: 2AZ, Public/Private Subnet 분리
- **ECS Fargate**: 서버리스 컨테이너 3개 서비스
- **ECR**: Docker 이미지 저장소 (3개 리포지토리)
- **ALB**: L7 로드밸런서 (경로 기반 라우팅)
- **RDS PostgreSQL**: Master/Slave 구성
- **Secrets Manager**: DB 접속 정보 암호화 관리

### 3. 보안 구성
- Private Subnet에 ECS/RDS 배치
- Security Group 최소 권한 원칙
- Secrets Manager로 민감 정보 관리
- Non-root Docker 컨테이너
- NAT Gateway를 통한 아웃바운드 트래픽

### 4. 고가용성
- Multi-AZ 구성 (2개 가용영역)
- ALB로 트래픽 분산
- RDS Multi-AZ (Master/Slave 복제)
- ECS Rolling Update (무중단 배포)

---

## 📝 배포과정설명.md 주요 내용

### 1. 아키텍처 개요
- 시스템 구성도 (ASCII 다이어그램)
- 주요 컴포넌트 설명
- 기술 스택

### 2. 전체 배포 흐름
- 5단계 자동화 프로세스
- 각 단계별 상세 설명
- 타임라인 (Git Push → 서비스 응답)

### 3. 각 단계별 상세 설명
#### Stage 1: Git Push → Jenkins 트리거
- GitHub Webhook 동작 방식
- Jenkins 자동 실행

#### Stage 2: Jenkins 빌드 프로세스
- Gradle 빌드 (bootJar)
- Docker Multi-stage Build
- 이미지 최적화 (약 300MB)

#### Stage 3: ECR 이미지 푸시
- 3개 리포지토리 (front/back1/back2)
- 버전 관리 전략 (latest + BUILD_NUMBER)
- 병렬 푸시

#### Stage 4: ECS 서비스 재배포
- Rolling Update 프로세스
- Task Definition 설정
- 환경변수 및 Secrets 주입

#### Stage 5: ALB를 통한 서비스 응답
- Target Group Health Check
- 경로 기반 라우팅
- 트래픽 분산

#### Stage 6: RDS PostgreSQL 연동
- Multi-AZ 구성
- Connection Pool 설정
- 고가용성

### 4. 네트워크 및 보안 구성
- VPC 구성 상세 (CIDR, Subnet)
- 4개 Security Group 규칙 표
- IGW, NAT Gateway 구성

### 5. 모니터링 및 로깅
- CloudWatch Logs 설정
- 주요 메트릭
- 알람 설정

### 6. 배포 시나리오 예시
- 정상 배포 (타임라인)
- 롤백 시나리오

### 7. 트러블슈팅 가이드
- 빌드 실패 대응
- ECS Task 시작 실패
- Health Check 실패
- DB 연결 실패

---

## 🎯 학습 성과

### DevOps 역량
✅ Git → Jenkins → ECR → ECS → ALB 전체 자동화 구현
✅ Infrastructure as Code 개념 적용
✅ CI/CD 파이프라인 설계 및 구축
✅ 무중단 배포 (Rolling Update) 구현

### AWS 클라우드 역량
✅ VPC 네트워크 설계 (2AZ, Public/Private Subnet)
✅ ECS Fargate 서버리스 컨테이너 운영
✅ ALB L7 로드밸런싱
✅ RDS Multi-AZ 고가용성 구성
✅ CloudWatch 모니터링 및 로깅

### 컨테이너 기술
✅ Docker Multi-stage Build
✅ 이미지 최적화 (레이어 캐싱)
✅ ECR 이미지 관리 및 버전 관리

### 보안
✅ Security Group 최소 권한 구성
✅ Secrets Manager 활용
✅ Private Subnet 격리
✅ IAM Role 기반 권한 관리

---

## 📌 제출 전 최종 확인

### 문서 확인
- [ ] 배포과정설명.md 파일명이 "이름_과정설명.md" 형식인가?
- [ ] 모든 다이어그램이 명확한가?
- [ ] 단계별 설명이 상세한가?
- [ ] 트러블슈팅 가이드가 포함되어 있는가?

### 파일 확인
- [ ] Dockerfile이 프로젝트 루트에 있는가?
- [ ] Jenkinsfile이 프로젝트 루트에 있는가?
- [ ] docker-compose.yml이 작동하는가?
- [ ] ECS Task Definition 3개가 있는가?

### 기술 확인
- [ ] Git → Jenkins 자동 트리거 가능한가?
- [ ] Jenkins → ECR 푸시 가능한가?
- [ ] ECR → ECS 배포 가능한가?
- [ ] ALB로 서비스 접근 가능한가?

---

## 📁 제출 방법

### 옵션 1: GitHub Repository 제출 (권장)
```bash
# 모든 파일을 GitHub에 푸시
git add .
git commit -m "docs: 과제 제출 - CI/CD 배포 자동화"
git push origin main

# Repository URL 제출
```

### 옵션 2: ZIP 파일 제출
```bash
# 필요한 파일만 압축
zip -r petclinic-devops.zip \
  배포과정설명.md \
  Dockerfile \
  Jenkinsfile \
  docker-compose.yml \
  ecs-task-definition-*.json \
  src/main/resources/application-prod.properties \
  README-DEVOPS.md \
  scripts/
```

---

## 🔍 평가 기준 대응

### Task 1-10 완료 여부 (100점)

| Task | 배점 | 완료 | 증빙 |
|------|------|------|------|
| VPC/Subnet 구성 | 15점 | ✅ | 배포과정설명.md - 네트워크 구성 섹션 |
| 보안그룹 설정 | 5점 | ✅ | 배포과정설명.md - 보안 그룹 표 |
| Jenkins 서버 구성 | 10점 | ✅ | Jenkinsfile, README-DEVOPS.md |
| ECR 리포지토리 | 5점 | ✅ | Jenkinsfile - ECR Push 단계 |
| ECS 클러스터/서비스 | 15점 | ✅ | ecs-task-definition-*.json (3개) |
| Jenkins Pipeline | 20점 | ✅ | Jenkinsfile (7단계 파이프라인) |
| ECR→ECS 배포 | 10점 | ✅ | 배포과정설명.md - 배포 흐름 |
| RDS 구성 | 10점 | ✅ | application-prod.properties, 배포과정설명.md |
| ALB 연동 | 5점 | ✅ | 배포과정설명.md - ALB 섹션 |
| CI/CD 검증 | 5점 | ✅ | 배포과정설명.md - 배포 시나리오 |
| **총점** | **100점** | ✅ | |

---

## 💡 추가 개선 가능 사항

### 과제 범위 외 (선택사항)
- [ ] HTTPS 인증서 (ACM) 적용
- [ ] Route53 도메인 연결
- [ ] CloudFront CDN 구성
- [ ] Auto Scaling 정책
- [ ] CloudWatch 알람 (SNS)
- [ ] WAF 보안 규칙
- [ ] X-Ray 분산 추적

---

## 📞 도움이 필요하신가요?

### 로컬 테스트
```bash
# 1. 로컬에서 Docker Compose로 테스트
docker-compose up -d
curl http://localhost:8080

# 2. 로컬 빌드 테스트 스크립트 실행
./scripts/local-build-test.sh
```

### AWS 배포 테스트
```bash
# AWS CLI 설정 확인
aws sts get-caller-identity

# 수동 배포 스크립트 실행
./scripts/aws-deploy.sh
```

### 문제 해결
- README-DEVOPS.md의 트러블슈팅 섹션 참고
- 배포과정설명.md의 트러블슈팅 가이드 참고

---

**작성일**: 2025년
**과제명**: DevOps CI/CD 기반 클라우드 네이티브 서비스 운영
**프로젝트**: Spring PetClinic
